<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>My Account</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link rel="icon" type="image/png" href="assets/img/favicon.ico" />
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
    rel="stylesheet">

  <!-- <link href="assets/css/merchant_style.css" rel="stylesheet" /> -->
  <!-- <link href="assets/css/custom_style.css" rel="stylesheet" /> -->
  <!-- <link href="assets/css/font-awesome.css" rel="stylesheet" /> -->

  <!-- Swiper CSS -->
  <link rel="stylesheet" href="./assets/css/swiper-bundle.min.css">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link href='https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css' rel='stylesheet'>
  <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css' rel='stylesheet'>
  <style></style>
  <script type='text/javascript' src=''></script>
  <script type='text/javascript' src='https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js'></script>
  <script type='text/javascript'
    src='https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js'></script>
  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">


  <!-- =======================================================
  * Template Name: Presento - v3.7.0
  * Template URL: https://bootstrapmade.com/presento-bootstrap-corporate-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>
  <div id="loader">
    <img src="./assets/img/loader2.gif" />
  </div>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top">
    <div class="container d-flex align-items-center justify-content-between">
      <h1 class="logo"><a href="/customer/index.html"><img src="assets/img/logo.png" alt="" class="img-fluid"></a></h1>
      <!-- Uncomment below if you prefer to use an image logo -->
      <div class="dropdown">
        <button class="btn dropdown-toggle" type="button" id="dropdown_coins" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          City
        </button>
        <div id="menu" class="dropdown-menu" aria-labelledby="dropdown_coins">
          <form class="px-4 py-2">
            <input type="search" class="form-control" id="searchCoin" placeholder="Delhi" autofocus="autofocus">
          </form>
          <div id="menuItems"></div>
          <div id="empty" class="dropdown-header">City Not Found</div>
        </div>
      </div>

      <div class="dropdown" style="width: 50%;">
        <div id="myInput" class="input-group rounded">
          <input id="search" type="search" class="form-control rounded" widht="1" placeholder="Search for Hobby Center Or an Event"
            aria-label="Search" aria-describedby="search-addon" />
          <span class="input-group-text border-0" id="search-addon">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search"
              viewBox="0 0 16 16">
              <path
                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
            </svg>
          </span>
        </div>
        <div id="searchSuggestions" class="dropdown-menu">
          <div id="suggestions"></div>
        </div>
      </div>
      

      <nav id="navbar" class="navbar">
        <ul>
          <div class="btn-group">
            <button type="button" id="greet" class="btn dropdown-toggle mr-3" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              Account & List
            </button>
            <div class="dropdown-menu text-center">
              <div id="login-div" class="container">
                <div class="btn text-white text-center mt-1"
                  style="background-color:rgba(21, 202, 187, 0.808);width:100%;color:black"><a
                    href="signin.html">Login</a></div>
              </div>
              <div id="sign-up"><a class="sign-up" href="signup.html" style="font-size:10px;color:black;">New User?
                  Create Account</a></div>
              <div id="signup-divider" class="dropdown-divider" style="border-color:rgba(11, 219, 202, 0.808);"></div>
              <div id="myAccount"><a class="dropdown-item" href="myAccount.html">My Account</a></div>
              <div id="bookingHistory"><a class="dropdown-item" href="bookingHistory.html">Booking History</a></div>
              <a class="dropdown-item" href="Coupons.html">Coupons</a>
              <div id="dividerAboveLogout" class="dropdown-divider" style="border-color:rgba(11, 219, 202, 0.808);">
              </div>
              <a id="logout" class="dropdown-item" href="#" onclick="logout();">Logout</a>
            </div>
          </div>
          <li class="mr-2
            " style="cursor: pointer;"><img id="notificationDiv" src="assets/img/active_notification.gif" width="30"
              height="30" class="img-fluid" data-bs-toggle="modal" data-bs-target="#notificationModal"></li>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <!-- <li><img id="favouritesDiv" src="assets/img/wishlist.png" width="30" height="30"
              class="img-fluid" data-bs-toggle="modal" data-bs-target="#wishlistModal" style="filter:grayscale"></li> -->

        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav><!-- .navbar -->
    </div>
  </header><!-- End Header -->

  <!-- Notification  -->
  <div class="modal fade" id="notificationModal" tabindex="-1" aria-labelledby="verificationModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="verificationModalLabel">Notifications</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Empty
        </div>

      </div>
    </div>
  </div>

  <!-- WishList -->
  <div class="modal fade" id="wishlistModal" tabindex="-1" aria-labelledby="verificationModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="verificationModalLabel">Wishlist</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="myFavouriteList">
        </div>
      </div>
    </div>
  </div>

  <main id="main">
    <section class="contact">
      <div class="container bg-light rounded" style="margin-top:5%; margin-bottom:2%;">
        <div class="section-title pt-5">
          <h2>Update Profile</h2>
        </div>
        <div class="row mb-5">
          <div class="" style="width:50%; float: left;">
            <!-- <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12 pl-5 pb-5"> -->

            <div class="ml-5 col">
              <h4><label for="file" style="cursor: pointer;">Upload Image</label></h4>
              <div id="error" class="rounded"
                style="display:none;width:55%;background-color:rgb(255, 197, 197);border-color:red">
                <ul class="text-justify" id="internal-error"
                  style="padding-top:10px; padding-bottom:10px;color:rgb(136, 0, 0)"></ul>
              </div>
              <p><small>Max Upload Size is 10MB</small></p>


              <input type="file" accept="image/gif, image/jpeg, image/png" name="image" id="file">
              <div class="btn text-white" onclick="updateImage()" style="background-color:#ffa500">Upload</div>
            </div>


            <!-- </div> -->
          </div>
          <div class="text-center" style="width:50%; float:right">
            <div id="profile-container">
              <image id="profileImage" src="" style="height:100%;;width:85%;" />
            </div>
          </div>
        </div>
        <div class="row mb-5">
          <div class="" style="width:50%; float: left">
            <!-- <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12 pl-5 pb-4"> -->
            <div class="form-group ml-5">
              <div class="row">
                <div class="col-4">
                  <h4>Full Name</h4>
                </div>
                <div class="col">
                  <a style="color:#00a2c2;cursor: pointer;" onclick='return update()'>Edit</a>
                </div>
              </div>

              <div class="" style="width:40%; float:left">
                <input type="text" class="form-control" id="name" placeholder="Enter Full Namer">
              </div>
              <div class="pl-3" style="width:20%; float:left">
                <div id="updateFullname" class="btn text-white text-center" style="display:none;background-color:#ffa500;width:100%;" onclick="updateFullName()">Save</div>
              </div>
            </div>
            <!-- </div> -->
            <br></br>
          </div>
          <div class="" style="width:50%; float:right">
            <!-- <div class="" style="width:50%; float: left"> -->
            <!-- <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12 pl-5 pb-4"> -->
            <div class="form-group">
              <div class="row">
                <div class="col-2">
                  <h4>Email</h4>
                </div>
                <div class="col">
                  <a href="./updatePassword.html" style="color:#00a2c2">Change Password</a>
                </div>
              </div>
              <div class="" style="width:40%; float:left">
                <input type="email" class="form-control" id="email" placeholder="Enter Email Id">
              </div>
              <!-- <div class="pl-3" style="width:20%; float:left">
                          <div class="btn text-white text-center" style="background-color:#ffa500;width:100%;">Save</div>
                      </div> -->
            </div>
            <!-- </div> -->
            <br></br>
            <!-- </div> -->
          </div>
        </div>
        <div class="row pb-5">
          <div class="" style="width:50%; float: left">
            <!-- <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12 pl-5 pb-4"> -->
            <div class="form-group ml-5">
              <h4>Contact Number</h4>
              <div class="" style="width:40%; float:left">
                <input type="text" class="form-control" id="contact" placeholder="Enter Contact Number">
              </div>
              <!-- <div class="pl-3" style="width:20%; float:left">
                          <div class="btn text-white text-center" style="background-color:#ffa500;width:100%;">Save</div>
                      </div>   -->
            </div>
            <!-- </div> -->
            <br></br>
          </div>
          <div class="" style="width:50%; float:right">
            <!-- <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12 pl-5 pb-5"> -->
            <div class="form-group">
              <h4>Whatsapp Number</h4>
              <div class="" style="width:40%; float:left">
                <input type="text" class="form-control" id="whatsapp" placeholder="NULL">
              </div>
              <!-- <div class="pl-3" style="width:20%; float:left">
                        <div class="btn text-white text-center" style="background-color:#ffa500;width:100%;">Save</div>
                    </div> -->
            </div>
            <!-- </div> -->
            <br></br>
          </div>
        </div>
        <!-- <div class="col ml-5">
          <div class="btn text-white mb-5" style="background-color:#ffa500; width:20%"><a href="./updatePassword.html"
              style="color:white">Change Password</a></div>
        </div> -->
      </div>
    </section>
  </main>

  <footer style="position: relative; z-index: 0;">
    <div class="footer-top text-white pt-5">
      <div class="container">
        <h1 class="logo"><a href="#"><img src="assets/img/logo.png" alt="" class="img-fluid"
              style="width: 70mm; height:12mm"></a></h1>
      </div>
      <div class="container">
        <div class="footer-about wow fadeInUp animated"
          style="visibility: visible; animation-name: fadeInUp; width: 70%; float:left">

          <h3>About us</h3>
          <p>
            Wipe away the problems from your life by experiencing a whole new and 
            creative platform proving hobbies. HOBBY CADDY is that platform that helps 
            you with different options as per your interest. Our team is here to fulfil 
            your dreams into reality. We aim to serve you with memorable activities, 
            tremendous opportunities, and creative feats. Join us and let us help you 
            fulfil your dreams, passion, and hobby. 
        </p>

        </div>
        <div class="" style="width: 20%; float:right">
          <h4>For Any Assistance</h4>
          <img src="./assets/img/mail.png" style="width: 10mm; height:10mm"> Business Inquiries</img>
          <p>hobbycaddy@gmail.com</p>
        </div>
      </div>
    </div>
    <div class="backstretch"
      style="left: 0px; top: 0px; overflow: hidden; margin: 0px; padding: 0px; height: 471.422px; width: 1349px; z-index: -999998; position: absolute; background-color:rgba(3, 90, 83, 0.808);">
      <img src="./assets/img/kenny-eliason-1-aA2Fadydc-unsplash.jpg"
        style="position: absolute; margin: 0px; padding: 0px; border: none; width: 1349px; height: 899.333px; max-height: none; max-width: none; z-index: -999999; left: 0px; top: -213.956px; opacity: 0.1">
    </div>
    <hr style="width:100%;margin-left:0;height:2px;color:white">
    <div class="container text-white text-center">
      <h3>Quick Links</h3>
      <br>
      <div class="row">
        <!--
        <div class="col-sm" style="font-size: 0.8em">
          List of Centres
        </div> -->
        <div class="col-sm" style="font-size: 0.8em">
          About
        </div>
        <div class="col-sm" style="font-size: 0.8em">
          Hiring
        </div>
        <div class="col-sm" style="font-size: 0.8em">
          Privacy Policy
        </div>
        <div class="col-sm" style="font-size: 0.8em">
          Guidelines and Policy
        </div>
        <div class="col-sm" style="font-size: 0.8em">
          Terms of Services
        </div>
        <div class="col-sm" style="font-size: 0.8em">
          FAQs
        </div>
        <!--
        <div class="col-sm">
          <button type="button" class="btn btn-warning text-white" style="font-size: 0.6em">Sell On Hobby Caddy</button>
        </div> -->
      </div>
    </div>
    <div class="container d-md-flex py-4 footer-bottom text-white">
      <div class="me-md-auto text-center text-md-start">
        <div class="copyright">
          &copy; Copyright <strong><span>Hobby Caddy</span></strong>. All Rights Reserved
        </div>
      </div>
      <div class="social-links text-center text-md-end pt-3 pt-md-0">
        <h6>Follow us on</h6>
        <a href="#" class="twitter"><img src="./assets/img/twitter.png" style="height:6mm"></a>
        <a href="#" class="facebook"><img src="./assets/img/facebook.png" style="height:6mm"></a>
        <a href="#" class="instagram"><img src="./assets/img/instagram.png" style="height:6mm"></a>
        <a href="#" class="linkedin"><img src="./assets/img/linkedin.png" style="height:6mm"></a>
      </div>
    </div>
  </footer>

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
      class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/purecounter/purecounter.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  <!-- Swiper JS -->
  <script src="./assets/js/swiper-bundle.min.js"></script>
  <!-- JavaScript -->
  <script src="./assets/js/script.js"></script>
  <script>
    var myInputWidth = (document.getElementById("myInput").offsetWidth);
    document.getElementById("myInput").style.width = myInputWidth * 0.8 + "px";
    //Initialize with the list of symbols
    let cityNames = ["Delhi"]

    //Find the input search box
    let search = document.getElementById("searchCoin")

    //Find every item inside the dropdown
    let items = document.getElementsByClassName("dropdown-city")
    function buildDropDownCity(values) {
      let contents = []
      for (let name of values) {
        contents.push('<input type="button" class="dropdown-item dropdown-city" type="button" value="' + name + '"/>')
      }
      $('#menuItems').append(contents.join(""))

      //Hide the row that shows no items were found
      $('#empty').hide()
    }

    //Capture the event when user types into the search box
    document.getElementById("searchCoin").addEventListener('input', function () {
      event.preventDefault();
      filterCity(search.value.trim().toLowerCase())
    })

    //For every word entered by the user, check if the symbol starts with that word
    //If it does show the symbol, else hide it
    function filterCity(word) {
      console.log(word)
      let length = items.length
      console.log(items)
      let collection = []
      let hidden = 0
      for (let i = 0; i < length; i++) {
        if (items[i].value.toLowerCase().startsWith(word)) {
          $(items[i]).show()
        }
        else {
          $(items[i]).hide()
          hidden++
        }
      }

      //If all items are hidden, show the empty view
      if (hidden === length) {
        $('#empty').show()
      }
      else {
        $('#empty').hide()
      }
    }

    //If the user clicks on any item, set the title of the button as the text of the item
    $('#menuItems').on('click', '.dropdown-item', function () {
      $('#dropdown_coins').text($(this)[0].value)
      $("#dropdown_coins").dropdown('toggle');
    })
    buildDropDownCity(cityNames)

    function updateFullName(){
      loader.style.height = "100%";
      loader.style.width = "100%";

      loader.style.borderRadius = "50%";
      loader.style.visibility = "visible";

      var name = document.getElementById("name").value;
      
      $.ajax({
        url: 'http://127.0.0.1:8080/api/customer/v1/updateFullName',
        type: 'PUT',
        contentType: "application/text;",
        dataType: 'json',
        data : name,
        crossDomain: true,
        headers: {
          Authorization: "Bearer " + getCookie("customerToken")
        },
        success: function (res, req) {
          loader.style.visibility = "hidden";
          document.getElementById("name").value = res.message;
          document.getElementById("name").disabled = true;
          document.getElementById("updateFullname").style.display="none";
          
        },
        error: function (e) {
          console.log(e);
          loader.style.visibility = "hidden";
        }
      });
    }

    function update(){
      document.getElementById("updateFullname").style.display="block";
      document.getElementById("name").disabled = false;
    }

    function getCookie(name) {
      var nameEQ = name + "=";
      var ca = document.cookie.split(';');
      for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
          c = c.substring(1, c.length);
        }
        if (c.indexOf(nameEQ) == 0) {
          return c.substring(nameEQ.length, c.length);
        }
      }
      return null;
    }

    $(document).ready(function () {
      $('#dropdown_coins').text("Delhi")
      loader.style.height = "100%";
      loader.style.width = "100%";

      loader.style.borderRadius = "50%";
      loader.style.visibility = "visible";
      $.ajax({
        url: 'http://127.0.0.1:8080/api/customer/v1/getCustomersName',
        type: 'GET',
        contentType: "application/json;",
        dataType: 'json',
        crossDomain: true,
        headers: {
          Authorization: "Bearer " + getCookie("customerToken")
        },
        success: function (res, req) {
          console.log(res);
          const name = res.customerFullName.split(" ");
          const firstName = name[0];
          document.getElementById("greet").innerHTML = "Hi, " + firstName;
          document.getElementById("login-div").style.display = "none";
          document.getElementById("sign-up").style.display = "none";
          document.getElementById("signup-divider").style.display = "none";
          document.getElementById("name").value = res.customerFullName;
          document.getElementById("email").value = res.customerEmailId;
          document.getElementById("contact").value = res.customerContactNumber;
          document.getElementById("whatsapp").value = res.customerWhatsappNumber;
          document.getElementById("email").disabled = true;
          document.getElementById("name").disabled = true;
          document.getElementById("contact").disabled = true;
          document.getElementById("whatsapp").disabled = true;
          document.getElementById("profileImage").setAttribute("src", res.customerImageUrl);
          // document.getElementById("favouritesDiv").setAttribute("data-bs-target", "#");
          document.getElementById("myFavouriteList").innerHTML = res.customerFavourites;
          loader.style.visibility = "hidden";
        },
        error: function (e) {
          location.href = '/signin.html'
        }
      });
    });

    function eraseCookie() {
      document.cookie = "customerToken" + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }

    //Logout
    function logout() {
      loader.style.height = "100%";
      loader.style.width = "100%";

      loader.style.borderRadius = "50%";
      loader.style.visibility = "visible";
      $.ajax({
        url: 'http://127.0.0.1:8080/api/customer/auth/signout',
        type: 'POST',
        contentType: "application/json;",
        crossDomain: true,
        withCredentials: true,
        headers: {
          Authorization: "Bearer " + getCookie("customerToken")
        },
        success: function (res, req) {
          eraseCookie();
          location.href = "http://localhost:5500/signin.html";
        },
        error: function (e) {
          location.href = '/signin.html';
        }
      });
    }

    function updateImage() {
      loader.style.height = "100%";
      loader.style.width = "100%";

      loader.style.borderRadius = "50%";
      loader.style.visibility = "visible";

      var fd = new FormData();

      if (document.getElementById("file").value == "") {
        loader.style.visibility = "hidden";
        document.getElementById("error").style.display = "block";
        document.getElementById("internal-error").innerHTML = "Select a File First";
      }
      else {
        fd.append("file", file.files[0]);
        var filesize = ((file.files[0].size / 1024) / 1024).toFixed(4);
        if (filesize > 10) {
          loader.style.visibility = "hidden";
          document.getElementById("error").style.display = "block";
          document.getElementById("internal-error").innerHTML = "File Size greater than 10MB";
        }
        else {
          $.ajax({
            url: 'http://127.0.0.1:8080/api/customer/v1/updateProfileV0',
            type: 'POST',
            contentType: false,
            processData: false,
            crossDomain: true,
            data: fd,
            withCredentials: true,
            headers: {
              Authorization: "Bearer " + getCookie("customerToken")
            },
            success: function (res, req) {
              loader.style.visibility = "hidden";
              location.reload();
            },
            error: function (e) {
              loader.style.visibility = "hidden";
              document.getElementById("error").style.display = "block";
              document.getElementById("internal-error").innerHTML = "Could Not Upload!";
            }
          });
        }
      }
    }

  </script>
</body>

</html>